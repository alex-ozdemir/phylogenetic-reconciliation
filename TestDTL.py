P = {('p8', 'p3'): ('p8', 'p3', None, None), ('p6', 'p8'):

('p6', 'p8', ('p8', 'p2'), ('p8', 'p3')), 'pTop': 

('Top', 'p6', ('p6', 'p1'), ('p6', 'p8')), ('p6', 

'p1'): ('p6', 'p1', None, None), ('p8', 'p2'): ('p8', 

'p2', None, None)}



fDTL = {('p8', 'h2'): [['T', ('p3', 'h2'), ('p4', 'h4'), 1], 1], 
('p7', 'h1'): [['T', ('p1', 'h1'), ('p2', 'h3'), 1], 1], 
('p1', 'h1'): [['C', (None, None), (None, None), 1], 0], 
('p6', 'h7'): [['S', ('p7', 'h1'), ('p8', 'h2'), 1], 2], 
('p3', 'h2'): [['C', (None, None), (None, None), 1], 0], 
('p8', 'h4'): [['T', ('p4', 'h4'), ('p3', 'h2'), 1], 1], 
('p2', 'h3'): [['C', (None, None), (None, None), 1], 0], 
('p6', 'h8'): [['S', ('p7', 'h3'), ('p8', 'h4'), 1], 2], 
('p7', 'h3'): [['T', ('p2', 'h3'), ('p1', 'h1'), 1], 1], 
('p4', 'h4'): [['C', (None, None), (None, None), 1], 0]}



newDTL = {('p8', 'h2'): [['T', ('p3', 'h2'), ('p4', 'h4'), 0], 1], 
('p6', 'h7'): [['S', ('p7', 'h1'), ('p8', 'h2'), 0], 2], 
('p3', 'h2'): [['C', (None, None), (None, None), 0], 0], 
('p8', 'h4'): [['T', ('p4', 'h4'), ('p3', 'h2'), 1], 1], 
('p2', 'h3'): [['C', (None, None), (None, None), 0], 0], 
('p7', 'h3'): [['T', ('p2', 'h3'), ('p1', 'h1'), 1], 1], 
('p7', 'h1'): [['T', ('p1', 'h1'), ('p2', 'h3'), 0], 1], 
('p1', 'h1'): [['C', (None, None), (None, None), 0], 0], 
('p6', 'h8'): [['S', ('p7', 'h3'), ('p8', 'h4'), 1], 2], 
('p4', 'h4'): [['C', (None, None), (None, None), 0], 0]}

booking: newDTL output
{('p8', 'h2'): [[('T', ('p3', 'h2'), ('p4', 'h4'), 0)], 0], 
('p7', 'h1'): [[('T', ('p1', 'h1'), ('p2', 'h3'), 0)], 0], 
('p1', 'h1'): [('C', (None, None), (None, None), 0), 0], 
('p6', 'h7'): [[('S', ('p7', 'h1'), ('p8', 'h2'), 0)], 0], 
('p3', 'h2'): [('C', (None, None), (None, None), 0), 0], 
('p8', 'h4'): [[('T', ('p4', 'h4'), ('p3', 'h2'), 1)], 0], 
('p2', 'h3'): [('C', (None, None), (None, None), 0), 0], 
('p6', 'h8'): [[('S', ('p7', 'h3'), ('p8', 'h4'), 1)], 0], 
('p7', 'h3'): [[('T', ('p2', 'h3'), ('p1', 'h1'), 1)], 0], 
('p4', 'h4'): [('C', (None, None), (None, None), 0), 0]}


DTL = {('p2', 'h2'): [['C', (None, None), (None, None), 1], 0], 
('p6', 'h6'): [['CO', ('p1', 'h1'), ('p8', 'h8'), 1], 0], 
('p3', 'h3'): [['C', (None, None), (None, None), 1], 0], 
('p1', 'h1'): [['C', (None, None), (None, None), 1], 0], 
('p8', 'h8'): [['CO', ('p2', 'h2'), ('p3', 'h3'), 1], 0]}

bookkeeping output
'BSFHMap:'
{('p8', 'h2'): [('T', ('p3', 'h2'), ('p4', 'h4'), 1), 2], 
('p7', 'h3'): [('T', ('p2', 'h3'), ('p1', 'h1'), 1), 2], 
('p7', 'h1'): [('T', ('p1', 'h1'), ('p2', 'h3'), 1), 2], 
('p1', 'h1'): [('C', (None, None), (None, None), 1), 1], 
('p6', 'h7'): [('S', ('p7', 'h1'), ('p8', 'h2'), 1), 4], 
('p3', 'h2'): [('C', (None, None), (None, None), 1), 1], 
('p8', 'h4'): [('T', ('p4', 'h4'), ('p3', 'h2'), 1), 2], 
('p2', 'h3'): [('C', (None, None), (None, None), 1), 1], 
('p6', 'h8'): [('S', ('p7', 'h3'), ('p8', 'h4'), 1), 4], 
('p4', 'h4'): [('C', (None, None), (None, None), 1), 1]}

{('p8', 'h2'): [('T', ('p3', 'h2'), ('p4', 'h4'), 1), 2], 
('p7', 'h3'): [('T', ('p2', 'h3'), ('p1', 'h1'), 1), 2], 
('p7', 'h1'): [('T', ('p1', 'h1'), ('p2', 'h3'), 1), 2], 
('p1', 'h1'): [('C', (None, None), (None, None), 1), 1], 
('p6', 'h7'): [('S', ('p7', 'h1'), ('p8', 'h2'), 1), 4], 
('p3', 'h2'): [('C', (None, None), (None, None), 1), 1], 
('p8', 'h4'): [('T', ('p4', 'h4'), ('p3', 'h2'), 1), 2], 
('p2', 'h3'): [('C', (None, None), (None, None), 1), 1],  
('p6', 'h8'): [('S', ('p7', 'h3'), ('p8', 'h4'), 1), 4], 
('p4', 'h4'): [('C', (None, None), (None, None), 1), 1]}



 'BSFHEvent:'
  {('T', ('p4', 'h4'), ('p3', 'h2'), 1): 2, 
  ('T', ('p3', 'h2'), ('p4', 'h4'), 1): 2, 
  ('T', ('p2', 'h3'), ('p1', 'h1'), 1): 2, 
  ('S', ('p7', 'h3'), ('p8', 'h4'), 1): 4, 
  ('T', ('p1', 'h1'), ('p2', 'h3'), 1): 2, 
  'S', ('p7', 'h1'), ('p8', 'h2'), 1): 4})


({('p8', 'h2'): ('T', ('p3', 'h2'), ('p4', 'h4')), 
	('p7', 'h1'): ('T', ('p1', 'h1'), ('p2', 'h3')), 
	('p1', 'h1'): ['C', (None, None), (None, None)], 
	('p6', 'h7'): ('S', ('p7', 'h1'), ('p8', 'h2')), 
	('p3', 'h2'): ['C', (None, None), (None, None)], 
	('p2', 'h3'): ['C', (None, None), (None, None)], 
	('p4', 'h4'): ['C', (None, None), (None, None)]}, 


{('p8', 'h2'): [['T', ('p3', 'h2'), ('p4', 'h4'), 0], 1], 
('p6', 'h7'): [['S', ('p7', 'h1'), ('p8', 'h2'), 0], 2], 
('p3', 'h2'): [['C', (None, None), (None, None), 0], 0], 
('p8', 'h4'): [['T', ('p4', 'h4'), ('p3', 'h2'), 1], 1], 
('p2', 'h3'): [['C', (None, None), (None, None), 0], 0], 
('p7', 'h3'): [['T', ('p2', 'h3'), ('p1', 'h1'), 1], 1], 
('p7', 'h1'): [['T', ('p1', 'h1'), ('p2', 'h3'), 0], 1], 
('p1', 'h1'): [['C', (None, None), (None, None), 0], 0], 
('p6', 'h8'): [['S', ('p7', 'h3'), ('p8', 'h4'), 1], 2], 
('p4', 'h4'): [['C', (None, None), (None, None), 0], 0]}

Greedy output:

currentDTL:  {('p8', 'h2'): [['T', ('p3', 'h2'), ('p4', 'h4'), 0], 1], 
('p6', 'h7'): [['S', ('p7', 'h1'), ('p8', 'h2'), 0], 2], 
('p3', 'h2'): [['C', (None, None), (None, None), 0], 0], 
('p8', 'h4'): [['T', ('p4', 'h4'), ('p3', 'h2'), 1], 1], 
('p2', 'h3'): [['C', (None, None), (None, None), 0], 0], 
('p7', 'h3'): [['T', ('p2', 'h3'), ('p1', 'h1'), 1], 1], 
('p7', 'h1'): [['T', ('p1', 'h1'), ('p2', 'h3'), 0], 1], 
('p1', 'h1'): [['C', (None, None), (None, None), 0], 0], 
('p6', 'h8'): [['S', ('p7', 'h3'), ('p8', 'h4'), 1], 2], 
('p4', 'h4'): [['C', (None, None), (None, None), 0], 0]}


currentDTL:  {('p8', 'h2'): [['T', ('p3', 'h2'), ('p4', 'h4'), 0], 1], 
('p6', 'h7'): [['S', ('p7', 'h1'), ('p8', 'h2'), 0], 2], 
('p3', 'h2'): [['C', (None, None), (None, None), 0], 0], 
('p8', 'h4'): [['T', ('p4', 'h4'), ('p3', 'h2'), 1], 1], 
('p2', 'h3'): [['C', (None, None), (None, None), 0], 0], 
('p7', 'h3'): [['T', ('p2', 'h3'), ('p1', 'h1'), 1], 1], 
('p7', 'h1'): [['T', ('p1', 'h1'), ('p2', 'h3'), 0], 1], 
('p1', 'h1'): [['C', (None, None), (None, None), 0], 0], 
('p6', 'h8'): [['S', ('p7', 'h3'), ('p8', 'h4'), 1], 2], 
('p4', 'h4'): [['C', (None, None), (None, None), 0], 0]}

new BSFHMap:  {('p8', 'h2'): [('T', ('p3', 'h2'), ('p4', 'h4'), 1), 2], 
('p7', 'h3'): [('T', ('p2', 'h3'), ('p1', 'h1'), 1), 2], 
('p7', 'h1'): [('T', ('p1', 'h1'), ('p2', 'h3'), 1), 2], 
('p1', 'h1'): [('C', (None, None), (None, None), 1), 1], 
('p6', 'h7'): [('S', ('p7', 'h1'), ('p8', 'h2'), 1), 4], 
('p3', 'h2'): [('C', (None, None), (None, None), 1), 1], 
('p8', 'h4'): [('T', ('p4', 'h4'), ('p3', 'h2'), 1), 2], 
('p2', 'h3'): [('C', (None, None), (None, None), 1), 1], 
('p6', 'h8'): [('S', ('p7', 'h3'), ('p8', 'h4'), 1), 4], 
('p4', 'h4'): [('C', (None, None), (None, None), 1), 1]}
new BSFHMap:  {('p8', 'h2'): [('T', ('p3', 'h2'), ('p4', 'h4'), 0), 2], 
('p7', 'h1'): [('T', ('p1', 'h1'), ('p2', 'h3'), 0), 2], 
('p1', 'h1'): [('C', (None, None), (None, None), 0), 1], 
('p6', 'h7'): [('S', ('p7', 'h1'), ('p8', 'h2'), 0), 4], 
('p3', 'h2'): [('C', (None, None), (None, None), 0), 1], 
('p8', 'h4'): [('T', ('p4', 'h4'), ('p3', 'h2'), 1), 2], 
('p2', 'h3'): [('C', (None, None), (None, None), 0), 1], 
('p6', 'h8'): [('S', ('p7', 'h3'), ('p8', 'h4'), 1), 4], 
('p7', 'h3'): [('T', ('p2', 'h3'), ('p1', 'h1'), 1), 2], 
('p4', 'h4'): [('C', (None, None), (None, None), 0), 1]}







[{('p8', 'h2'): ('T', ('p3', 'h2'), ('p4', 'h4')), 
('p7', 'h1'): ('T', ('p1', 'h1'), ('p2', 'h3')), 
('p1', 'h1'): ('C', (None, None), (None, None)), 
('p6', 'h7'): ('S', ('p7', 'h1'), ('p8', 'h2')), 
('p3', 'h2'): ('C', (None, None), (None, None)), 
('p2', 'h3'): ('C', (None, None), (None, None)), 
('p4', 'h4'): ('C', (None, None), (None, None))}, 

{('p8', 'h2'): ('T', ('p3', 'h2'), ('p4', 'h4')), 
('p7', 'h1'): ('T', ('p1', 'h1'), ('p2', 'h3')), 
('p1', 'h1'): ('C', (None, None), (None, None)), 
('p6', 'h7'): ('S', ('p7', 'h1'), ('p8', 'h2')), 
('p3', 'h2'): ('C', (None, None), (None, None)), 
('p2', 'h3'): ('C', (None, None), (None, None)), 
('p4', 'h4'): ('C', (None, None), (None, None))}]




we did it!!!!!

[{('p8', 'h2'): ('T', ('p3', 'h2'), ('p4', 'h4')), 
('p7', 'h1'): ('T', ('p1', 'h1'), ('p2', 'h3')), 
('p1', 'h1'): ('C', (None, None), (None, None)), 
'p6', 'h7'): ('S', ('p7', 'h1'), ('p8', 'h2')), 
('p3', 'h2'): ('C', (None, None), (None, None)), 
('p2', 'h3'): ('C', (None, None), (None, None)), 
('p4', 'h4'): ('C', (None, None), (None, None))}, 

{('p7', 'h3'): ('T', ('p2', 'h3'), ('p1', 'h1')), 
('p1', 'h1'): ('C', (None, None), (None, None)), 
('p3', 'h2'): ('C', (None, None), (None, None)), 
('p8', 'h4'): ('T', ('p4', 'h4'), ('p3', 'h2')), 
('p2', 'h3'): ('C', (None, None), (None, None)), 
('p6', 'h8'): ('S', ('p7', 'h3'), ('p8', 'h4')), 
('p4', 'h4'): ('C', (None, None), (None, None))}]


 bookkeeping(newDTL, P):
 {('p8', 'h2'): [('T', ('p3', 'h2'), ('p4', 'h4'), 0), 0], 
 ('p7', 'h1'): [('T', ('p1', 'h1'), ('p2', 'h3'), 0), 0], 
 ('p1', 'h1'): [('C', (None, None), (None, None), 0), 0], 
 ('p6', 'h7'): [('S', ('p7', 'h1'), ('p8', 'h2'), 0), 0], 
 ('p3', 'h2'): [('C', (None, None), (None, None), 0), 0], 
 ('p8', 'h4'): [('T', ('p4', 'h4'), ('p3', 'h2'), 1), 1], 
 ('p2', 'h3'): [('C', (None, None), (None, None), 0), 0], 
 ('p6', 'h8'): [('S', ('p7', 'h3'), ('p8', 'h4'), 1), 3], 
 ('p7', 'h3'): [('T', ('p2', 'h3'), ('p1', 'h1'), 1), 1], 
 ('p4', 'h4'): [('C', (None, None), (None, None), 0), 0]}

















